---
title: "Hardening Your Clawdbot Server: A Complete Security Guide"
description: "within 60 seconds of setting up fail2ban, it caught an active brute-force attack. here's how to lock down your clawdbot server properly."
publishedAt: "2026-01-27"
author: "Jo V"
category: "DevOps"
tags: ["Clawdbot", "Security", "Linux", "DevOps", "Server", "SSH"]
coverImage: "/assets/blog/server-security-fail2ban/cover.png"
featured: false
---

I set up fail2ban on my Clawdbot server tonight. Within 60 seconds, it banned its first attacker.

Not a test. An actual bot was actively trying to brute-force SSH while I was configuring the firewall.

```
Jan 27 02:46:55 sshd: Invalid user oracle from 217.154.38.135
Jan 27 02:47:25 sshd: Invalid user main from 217.154.38.135
Jan 27 02:47:56 sshd: Invalid user HwHiAiUser from 217.154.38.135
Jan 27 02:48:26 sshd: Invalid user guest from 217.154.38.135
Jan 27 02:48:57 sshd: Invalid user git from 217.154.38.135
```

Every 30 seconds. Different usernames. Automated. Relentless.

Then fail2ban kicked in:

```
2026-01-27 02:50:54 NOTICE [sshd] Ban 217.154.38.135
```

Done. 30-day ban. If you're running Clawdbot on a VPS, you need this.

## Why Clawdbot Servers Are Targets

Clawdbot servers are juicy targets because they typically have:

- **Shell access** — The agent can run commands
- **API credentials** — Anthropic, OpenAI, messaging platforms
- **Personal data** — Session logs, memory files, contacts
- **Always-on connectivity** — 24/7 uptime on cloud VPS

An attacker who compromises your Clawdbot server gets access to your AI assistant's full capabilities. They could read your conversations, impersonate you on messaging platforms, or rack up API bills.

Let's fix that.

## Two Layers of Security

You need both:

**OS-Level Protection (this guide)**
- fail2ban — Auto-bans brute-force attackers
- ufw — Firewall that blocks everything by default

**Clawdbot-Level Protection (built-in)**
- `clawdbot security audit` — Checks for misconfigurations
- Workspace permissions — Protects session logs and credentials
- Channel allowlists — Controls who can talk to your bot

We'll cover both.

## Part 1: OS-Level Hardening

### Install fail2ban and ufw

```bash
sudo apt update
sudo apt install -y fail2ban ufw
```

### Configure fail2ban

Create a local config:

```bash
sudo tee /etc/fail2ban/jail.local << 'EOF'
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 2592000
findtime = 600
EOF
```

What this does:
- **maxretry = 3** — Three failed attempts = banned
- **bantime = 2592000** — 30-day ban (if you use SSH keys, any failed attempt is definitely an attacker)
- **findtime = 600** — Attempts counted within 10-minute window

Start it:

```bash
sudo systemctl enable fail2ban
sudo systemctl restart fail2ban
```

Check if it's working:

```bash
sudo fail2ban-client status sshd
```

### Configure ufw

```bash
# Default: block everything incoming
sudo ufw default deny incoming
sudo ufw default allow outgoing

# Allow only what Clawdbot needs
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP (if using webhooks)
sudo ufw allow 443/tcp   # HTTPS

# Enable
sudo ufw --force enable
```

Verify:

```bash
sudo ufw status verbose
```

That's it for OS-level. Now let's check Clawdbot itself.

## Part 2: Clawdbot Security Audit

Clawdbot has a built-in security scanner. Run it:

```bash
clawdbot security audit
```

For a deeper check:

```bash
clawdbot security audit --deep
```

To auto-fix common issues:

```bash
clawdbot security audit --fix
```

### What the Audit Checks

- **Inbound access** — Can strangers message your bot?
- **Tool blast radius** — Could prompt injection lead to shell access?
- **Network exposure** — Is your Gateway exposed without auth?
- **Browser control** — Is remote browser control secured?
- **Disk permissions** — Are credentials and logs protected?
- **Plugins** — Are untrusted extensions loaded?

### Fix Workspace Permissions

The audit will likely warn about permissions. Fix them:

```bash
chmod 700 ~/.clawdbot
chmod 600 ~/.clawdbot/clawdbot.json
```

This ensures only your user can read Clawdbot's config and credentials.

### Credential Storage Locations

Know where your secrets live:

- **Telegram token:** config or `channels.telegram.tokenFile`
- **WhatsApp auth:** `~/.clawdbot/credentials/whatsapp/*/creds.json`
- **Pairing allowlists:** `~/.clawdbot/credentials/*-allowFrom.json`
- **Session logs:** `~/.clawdbot/agents/*/sessions/*.jsonl`

All of these should be readable only by your user (not group/world).

## Part 3: Channel Security

### Lock Down DMs

By default, Clawdbot might accept messages from anyone. Tighten it:

In your config, set DM policies to `allowlist`:

```json
{
  "channels": {
    "telegram": {
      "dmPolicy": "allowlist",
      "dmAllowFrom": ["your_telegram_id"]
    }
  }
}
```

### Lock Down Groups

Same for groups — use allowlists instead of open:

```json
{
  "groupPolicy": "allowlist",
  "groupAllowFrom": ["allowed_group_id"]
}
```

The security audit will flag open policies.

## The Complete 5-Minute Setup

Copy-paste this entire block to harden a fresh Clawdbot server:

```bash
# Install security tools
sudo apt update && sudo apt install -y fail2ban ufw

# Configure fail2ban
sudo tee /etc/fail2ban/jail.local << 'EOF'
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 2592000
findtime = 600
EOF

# Start fail2ban
sudo systemctl enable fail2ban
sudo systemctl restart fail2ban

# Configure firewall
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw --force enable

# Fix Clawdbot permissions
chmod 700 ~/.clawdbot
chmod 600 ~/.clawdbot/clawdbot.json 2>/dev/null

# Run Clawdbot security audit
clawdbot security audit --fix

# Verify everything
echo "=== fail2ban status ==="
sudo fail2ban-client status sshd
echo "=== ufw status ==="
sudo ufw status verbose
echo "=== Clawdbot security ==="
clawdbot security audit
```

## What Attackers Actually Try

From my server logs in just one hour:

- **oracle** — Oracle DB default user
- **postgres** — PostgreSQL default
- **git** — GitLab/Gitea servers
- **solana** — Crypto node operators (popular target)
- **HwHiAiUser** — Huawei device default
- **admin, root** — The classics
- **ftpuser** — Legacy FTP

They spray common usernames hoping something sticks. fail2ban stops them after 3 attempts.

## Advanced: Additional Hardening

### Change SSH Port

Move from 22 to something random:

```bash
# In /etc/ssh/sshd_config
Port 45678
```

Update firewall:

```bash
sudo ufw allow 45678/tcp
sudo ufw delete allow 22/tcp
sudo systemctl restart sshd
```

### Use SSH Key Authentication (Critical)

Password authentication is the weakest link. SSH keys are cryptographically secure and impossible to brute-force.

**On your local machine**, generate a key pair:

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```

This creates two files:
- `~/.ssh/id_ed25519` — Your private key (never share this)
- `~/.ssh/id_ed25519.pub` — Your public key (goes on the server)

**Copy your public key to the server:**

```bash
ssh-copy-id user@your-server-ip
```

Or manually:

```bash
# On your local machine
cat ~/.ssh/id_ed25519.pub

# Copy the output, then on your server:
echo "your-public-key-here" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
```

**Test it works:**

```bash
ssh user@your-server-ip
```

If you get in without a password prompt, it's working.

### Disable Password Auth

Once SSH keys work, disable password authentication entirely:

```bash
sudo nano /etc/ssh/sshd_config
```

Find and change these lines:

```
PasswordAuthentication no
PubkeyAuthentication yes
ChallengeResponseAuthentication no
```

Restart SSH:

```bash
sudo systemctl restart sshd
```

Now the only way in is with your private key. Brute-force attacks become completely pointless — they're trying to guess a password that doesn't exist.

### Use `pass` for Secrets Management

Don't store API keys and passwords in plaintext config files. Use [pass](https://www.passwordstore.org/) — the standard Unix password manager.

**Install it:**

```bash
sudo apt install pass gnupg
```

**Set it up:**

```bash
# Generate a GPG key (if you don't have one)
gpg --gen-key

# Initialize pass with your GPG key
pass init "your-email@example.com"
```

**Store secrets:**

```bash
pass insert api/anthropic
pass insert api/openai
pass insert gmail/app-password
```

**Retrieve secrets in scripts:**

```bash
export ANTHROPIC_API_KEY=$(pass show api/anthropic)
```

**Why this matters:**
- Secrets are GPG-encrypted at rest
- Even if someone accesses your filesystem, they can't read the passwords without your GPG key
- You can sync your password store via git (safely, since everything is encrypted)
- Works great with Clawdbot — store your API keys and channel tokens securely

Your `~/.password-store/` directory is encrypted. Your `~/.clawdbot/clawdbot.json` with plaintext tokens? Not so much.

### Use Tailscale

For maximum security, put Clawdbot behind [Tailscale](https://tailscale.com). Your Gateway becomes accessible only through your private mesh network — zero public exposure.

Clawdbot has native Tailscale support:

```bash
clawdbot gateway --tailscale
```

## Monitor Ongoing Attacks

Check who's been banned:

```bash
sudo fail2ban-client status sshd
```

Watch live bans:

```bash
sudo tail -f /var/log/fail2ban.log | grep Ban
```

Check recent SSH attempts:

```bash
journalctl -u ssh -n 50 | grep -E "Failed|Invalid"
```

## It's Not Paranoia

I looked at my logs after just one day running Clawdbot on a public VPS:

- 847 failed SSH attempts
- 12 unique IPs banned
- Attacks from 6 different countries

This is normal. Every server with a public IP experiences this. The question isn't whether you'll be attacked — it's whether you're prepared.

Five minutes of setup. Sleep better at night.

---

*For more Clawdbot security details, check the [official security docs](https://docs.clawd.bot/gateway/security).*
